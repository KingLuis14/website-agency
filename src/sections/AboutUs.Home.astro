---
import { Icon } from "astro-icon/components";
---

<section class="section-page">
  <div class="wrapper">
    <div class="container">
      <div>
        <img
          class="container__img"
          src="https://integro.ancorathemes.com/wp-content/uploads/elementor/thumbs/img-6-copyright-qk4t0xx8xp2ymywwuyacahslqwlvzmj3pz6zlvo0dc.jpg"
          alt="img1"
        />
      </div>
      <div class="container__content">
        <small>All you need</small>
        <h2 >
          Capacitación Tecnológica Especializada para un Futuro Más Innovador
        </h2>
        <footer>
          <p>
            IFT es una empresa especializada en capacitaciones tecnológicas. Con
            nuestro RUC 20611910224, ofrecemos programas de formación de
            vanguardia en diversas áreas de la tecnología, desde desarrollo de
            software hasta ciberseguridad.
          </p>
          <a href="#" class="button button--accent">Todos los cursos <Icon name={"link-arrow"} size={15} /></a>
        </footer>
      </div>
    </div>
  </div>
</section>

<section class="section-page section-page--counters bg-color-blue-700">
   <div class="wrapper">
      <div class="counters-container color-white-000">
         <div class="counter" >
           <p  >Alumnos</p>
           <p >
             <span class="color-green-500">+</span>
             <span class="counter__number" data-target="1000">0</span>
           </p>
         </div>
         <div class="counter">
           <p >Cursos</p>
           <p  >
             <span class="color-green-500">+</span>
             <span class="counter__number" data-target="20">0</span>
           </p>
         </div>
         <div class="counter">
           <p  >Profesores</p>
           <p >
             <span class="color-green-500">+</span>
             <span class="counter__number" data-target="15">0</span>
           </p>
         </div>
       </div>
   </div>
</section>


<section class="section-page">
  <div class="wrapper">
    <div class="container">
      <div>
        <img
          class="container__img"
          src="https://integro.ancorathemes.com/wp-content/uploads/elementor/thumbs/img-6-copyright-qk4t0xx8xp2ymywwuyacahslqwlvzmj3pz6zlvo0dc.jpg"
          alt="img1"
        />
      </div>
      <div class="container__content reverse">
        <small >All you need</small>
        <h2 >
          Capacitación Profesional Impartida por Expertos en Tecnología
        </h2>
        <footer>
          <p >
            Nuestros cursos, impartidos por expertos en la materia, están
            diseñados para satisfacer las demandas del mercado laboral actual y
            proporcionar a nuestros estudiantes las habilidades necesarias para
            destacarse en la industria.
          </p>
          <a href="#" class="button button--accent">Todos los cursos <Icon name={"link-arrow"} size={15} /></a>
        </footer>
      </div>
    </div>
    
  </div>
</section>





<style lang="scss">
  .container {
    display: grid;
    grid-template-columns: minmax(auto, 1fr);
    gap: 2rem;

    &__img {
      min-height: 100%;
    }

    &__content {
      align-self: center;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      max-width: 70ch;

      > small {
        text-transform: uppercase;
      }
      > h2 {
        text-transform: uppercase;
      }

      > footer {
        > p {
          margin-bottom: 1.5rem;
          text-wrap: pretty;
        }
        @media (width >= 1200px) {
          margin-top: auto;
          margin-left: 4rem;
        }
      }

      &.reverse {
        @media (width >= 768px) {
          order: -1;
        }

        > small,
        h2 {
         //  text-align: right;

          @media (width >= 768px) {
            text-align: right;
         }
        }

        > footer {
          > p {
            margin-bottom: 1.5rem;
          }
          @media (width >= 1200px) {
            margin-top: auto;
            margin-left: 0;
            margin-right: 4rem;
          }
        }
      }

      @media (width >= 1200px) {
        align-self: stretch;
        padding-inline: 2rem;
        padding-block: 1rem;
      }
    }

    @media (width >= 768px) {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  .counters-container {
   //  margin-top: var(--padding-section);
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: .5rem;
  }

  .counter {
   //  flex: 1 0 clamp(150px, 40%, 250px);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-variant-numeric: tabular-nums;
    padding-block: 1.5rem;
    line-height: normal;
    gap: .5rem;
   //  background-color: cadetblue;

   > p:last-child{
      display: flex;
      font-size: clamp(2rem, 3.8788vw + 1.0909rem, 4rem);
      // background-color: crimson;
   }

  }
</style>

<script>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const counter = entry.target as HTMLElement;
        startCounter(counter, 750);
        observer.unobserve(counter);
      }
    });
  });

  const startCounter = (
    counter: HTMLElement,
    duration: number = 2500
  ): void => {
    const target = +counter.getAttribute("data-target")!;
    let count = 0;
    const startTime = performance.now();

    const updateCounter = (timestamp: number) => {
      const elapsedTime = timestamp - startTime;
      const progress = Math.min(elapsedTime / duration, 1);

      count = Math.floor(progress * target);
      counter.innerText = numberWithCommas(count);

      if (progress < 1) {
        requestAnimationFrame(updateCounter);
      } else {
        counter.innerText = numberWithCommas(target); // Asegurarse de que el valor final sea exacto
      }
    };

    requestAnimationFrame(updateCounter);
  };

  // Función para formatear números con comas
  const numberWithCommas = (x: number): string => {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  };

  const counterAnimationObserver = (): void => {
    const counters = document.querySelectorAll<HTMLElement>(".counter__number");
    counters.forEach((counter) => {
      observer.observe(counter);
    });
  };

  // Iniciar la función de animación
  counterAnimationObserver();
</script>
